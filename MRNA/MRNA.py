from Bio.Data import CodonTable

# Input: protein sequence (use 1-letter amino acid codes, no stop)
protein_seq = "MQYERQWTKAPNAINLIPMSGCSKTLHLIMFRNFCYMPHWCRAMKSSKGDMQDPFIQIIDEMVCYTHANDWKMQKTRQFWMWDIMKHFEWAFERDADSYWYSGDKDDDSRGTEDRGPDNQGYFEWTNTNACQIARLQGDMQFIACEWAEPDAMMKPVRPVDHSFATPPAAICRVSKTRRYFVAQGWTNPRPLKYSQMWSVFFKCNTQLPQDYVVEGVGETHMTYIIFMTGHEWFGLILLLQQPYCKVAAVDKKIDLMASTMQMIIGAFSIRFPHPYGCNSNHGCCMHHKPDADLGYQMDLDYCKSRFVQQNQLDHEWDTRRRTVCHIWEGWDKNNCPMNHETCIHVLEGFDPERYQECESANIECMFNLPELWSAFAVLVVDFVQYFMFTWLNGRQHGPQCWLKPRFDYASCCTAGKVIACYVGMVPRKTSYCPIESRTFNNLYRVYAPFTFMVYSYSQHDWAVPAFPPVRFEVEMLSSHIYNIKSAYCNKFNCQMPALQSEQHGKRHDWHYQNNLVDGFNVMLGSSFACPQSQDYGMNFTMFYEDIVCLFMRGKNHLKTHICVMHHYFFGVTAQIAWRARKQHHCCDNLLMPKYCSDVYDCMYHGGDIINSWPMGPQYKDEQKWELDMAWMWLYTKVRAAAADQWPNKADDQWSPNYEAFSWWAGEYQMKTCVRRISTDLALSIMLFQSTSWDAHVEVMRKSTMGEKDCGPETCYLNQFGRGSAINDGVDCNYIYCAENMVDCVSNITTTPYTGDCILNSFVFHLQTSRCPKLFNSNPFAYIYMYVKYSTGEVPGSDCQKKWAMHGCFAWENMADVIPTGDKTLHGLHQLIIMMAHTVQYQVWPFRALPDQHARPFLQQITMHKQCNDNSFKRHRNGGRWPHEGIKKRPPRQIVQIYILKNQKIRLYKEENWERAKLYNVNHYCLMSNVCYIMWNPATFHKKYWVEFNALHGLCYVAPHAYPMAMRSGHMMAISRERRSRTEPIRAISKEHWSWFLMC"  # Example input

# Use the standard RNA codon table
table = CodonTable.unambiguous_rna_by_id[1]

# Build mapping from amino acid to list of codons
aa_to_codons = {}
for codon, aa in table.forward_table.items():
    aa_to_codons.setdefault(aa, []).append(codon)

# MOD value
MOD = 1_000_000

# Start with 1, and multiply number of codons for each amino acid
count = 1
for aa in protein_seq:
    if aa not in aa_to_codons:
        raise ValueError(f"Invalid amino acid: {aa}")
    count = (count * len(aa_to_codons[aa])) % MOD

# Multiply by number of stop codons (protein always ends with stop)
count = (count * len(table.stop_codons)) % MOD

# Output the result
print(count)
